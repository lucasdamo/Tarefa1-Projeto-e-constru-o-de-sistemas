<?xml version="1.0" encoding="UTF-8"?>
<ruleset name="Presto Custom Code Style"
    xmlns="http://pmd.sourceforge.net/ruleset/2.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://pmd.sourceforge.net/ruleset/2.0.0 http://pmd.sourceforge.net/ruleset_2_0_0.xsd">

    <description>
	Custom PrestoDB ruleset for PMD, based on the default ruleset used by the Maven PMD Plugin. 

        It contains the rules of the old (pre PMD 6.0.0) rulesets java-basic, java-empty, java-imports,
        java-unnecessary, java-unusedcode.
    </description>

    <rule ref="category/java/bestpractices.xml" />
  
    <rule ref="category/java/codestyle.xml" />
 
    <rule ref="category/java/design.xml" />

    <rule ref="category/java/errorprone.xml" />

    <rule ref="category/java/multithreading.xml" />

    <rule ref="category/java/performance.xml" />

    <!-- Presto code style rules -->
    <rule ref="category/java/design.xml/SimplifiedTernary" />
    
    <rule name="UncategorizedException"
      language="java"
      message="Exception not categorized by PrestoException function call"
      class="net.sourceforge.pmd.lang.rule.XPathRule">
	    <description>
	    	Third rule from presto code style: Categorize errors when throwing exceptions.
		 For example, PrestoException takes an error code as an argument, 
		 PrestoException(HIVE_TOO_MANY_OPEN_PARTITIONS). This categorization lets you
		 generate reports so you can monitor the frequency of various failures.	
	    </description>
	    <priority>4</priority>
	    <properties>
		    <property name="version" value="2.0"/>
		    <property name="xpath">
			    <value>
				<![CDATA[
				//ThrowStatement[@FirstClassOrInterfaceTypeImage="Exception"]
				]]>
			    </value>
		    </property>
	    </properties>
    </rule>

</ruleset>
